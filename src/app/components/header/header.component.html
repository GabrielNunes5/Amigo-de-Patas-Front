<header
class="backdrop-blur-md fixed top-0 left-0 right-0 z-50 transition-all duration-300 ease-in-out py-2 px-4 md:px-12"
[ngClass]="isScrolled() ? 'bg-transparent' : 'bg-white/90 shadow-sm'">
    <div class="max-w-7xl mx-auto">
        <div class="flex justify-between items-center h-14">
            <a routerLink="/" class="flex items-center gap-3">
                <div class="w-12 h-12 bg-gradient-to-r from-blue-500 to-green-500 rounded-full flex items-center justify-center">
                    <lucide-angular [img]="PawPrint" class="w-8 h-8 text-white"/>
                </div>
                <div>
                    <h1 class="text-xl font-bold" [ngClass]="isScrolled() ? 'text-gray-800' : 'bg-gradient-to-r from-blue-600 to-green-600 bg-clip-text text-transparent'">
                        Amigo de Patas
                    </h1>
                    <p [ngClass]="isScrolled() ? 'text-gray-800 text-xs' : 'text-gray-500 text-xs'">
                        ONG • Adoção Responsável
                    </p>
                </div>
            </a>
            <nav class="hidden md:flex items-center space-x-1">
                @for (item of navigationItems; track item.url) {
                    <a
                    [routerLink]="item.url"
                    class="px-4 py-2 rounded-lg font-medium transition-all duration-200 flex items-center gap-2"
                    [ngClass]="router.url === item.url
                    ? (isScrolled() ? 'bg-transparent text-gray-800 shadow'
                    : 'bg-blue-100 text-blue-700')
                    : (isScrolled()
                    ? 'text-gray-800 hover:bg-blue-500 hover:text-white'
                    : 'text-gray-600 hover:bg-gray-100 hover:text-gray-900')">
                        <lucide-angular [img]="item.icon" class="w-4 h-4"/>
                        {{ item.title }}
                    </a>
                }
                <div class="relative">
                    @if (currentUser()) {
                        <div class="flex items-center gap-3 cursor-pointer py-2 px-2 select-none"
                        (click)="toggleDropdown()">
                            <div class="w-8 h-8 rounded-full flex items-center justify-center"
                            [ngClass]="isScrolled() ? 'bg-transparent text-gray-800' : 'text-white bg-gradient-to-r from-blue-500 to-green-500'">
                                <span class="font-medium">
                                    {{ currentUser()?.adopterFullName?.[0]?.toUpperCase() }}
                                </span>
                            </div>
                            <span class="font-medium">
                                {{ getFirstTwoNames(currentUser()?.adopterFullName) }}
                            </span>
                        </div>
                    @if (isDropdownOpen()) {
                        <div class="absolute right-0 mt-2 min-w-64 bg-gray-200 border border-gray-400 rounded-lg shadow-lg py-2 z-50">
                            <div class="m-2 px-1 border-b border-gray-100">
                                <p class="font-semibold text-gray-800 text-sm">
                                    {{ currentUser()?.adopterFullName }}
                                </p>
                                <p class="text-gray-500 text-xs truncate">
                                    {{ currentUser()?.adopterEmail }}
                                </p>
                            </div>
                            <button (click)="logout()" class="cursor-pointer text-left ml-2 px-1 py-1 text-md font-semibold text-red-700 hover:text-red-800 transition">
                                Sair
                            </button>
                            @if(isAdmin()){
                                <button 
                                (click)="goToAdmin()" 
                                class="cursor-pointer text-left font-semibold mt-1 px-1 py-1 text-md text-blue-700 hover:text-blue-800 transition">
                                    Admin
                                </button>
                            }
                        </div>
                    }
                    } @else {
                        <a class="py-2 px-2 gap-2 flex font-medium items-center rounded-lg transition-all duration-200"
                        [ngClass]="isScrolled() ? 'bg-transparent text-gray-800 hover:bg-blue-500 hover:text-white' : 'bg-gradient-to-r from-blue-600 to-green-600 hover:from-blue-700 hover:to-green-700 text-white'"
                        routerLink='auth/login'>
                            <lucide-angular [img]="LogIn" class="w-4 h-4" />
                            Entrar
                        </a>
                    }
                </div>
            </nav>
            <button type="button"class="md:hidden p-2 rounded-full hover:bg-gray-100 transition"(click)="toggleMobileMenu()">
                <lucide-angular [img]="mobileMenuOpen() ? X : Menu" class="w-5 h-5"/>
            </button>
        </div>
        @if (mobileMenuOpen()) {
            <nav 
            class="md:hidden mt-2 rounded-lg px-4 py-2 space-y-1"
            [ngClass]="isScrolled() ? 'bg-transparent' : 'bg-white'">
                @for (item of navigationItems; track item.url) {
                    <a
                    [routerLink]="item.url"
                    (click)="closeMobileMenu()"
                    class="flex items-center gap-3 px-4 py-3 rounded-lg font-medium transition-all duration-200"
                    [ngClass]="router.url === item.url ? 'bg-blue-100 text-blue-700' : 'text-gray-600'">
                        <lucide-angular [img]="item.icon" class="w-5 h-5"/>
                        {{ item.title }}
                    </a>
                }
                @if(currentUser()){
                    <div class="border border-gray-400 rounded w-fit py-2 px-2 flex flex-col items-center mx-auto">
                        <p class="font-semibold text-gray-800">
                            {{ currentUser()?.adopterFullName }}
                        </p>
                        <button (click)="logout()" class="font-semibold bg-red-200 rounded mt-1 px-2 py-1 text-md text-red-700">
                            Sair
                        </button>
                        @if(isAdmin()){
                            <button (click)="goToAdmin()" class="font-semibold bg-blue-200 rounded mt-1 px-2 py-1 text-md text-blue-700">
                                Admin
                            </button>
                        }
                    </div>
                }@else {
                    <a class="py-2 px-2 gap-2 mx-auto w-fit flex font-medium items-center rounded-lg transition-all duration-200"
                    [ngClass]="isScrolled() ? 'bg-transparent text-gray-800 border' : 'bg-gradient-to-r from-blue-600 to-green-600 text-white'"
                    routerLink='auth/login'>
                        <lucide-angular [img]="LogIn" class="w-4 h-4" />
                        Entrar
                    </a>
                }
            </nav>
        }
    </div>
</header>
